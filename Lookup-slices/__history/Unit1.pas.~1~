unit Unit1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls;


type
  TSyntaxNodeType = (ntAddr,ntDeref);



  SyntaxNodeNames = record //<<-------- fails

  //change record to class and it works.

  strict private

    class var FData: array[TSyntaxNodeType] of string;

    class function GetItem(const index: TSyntaxNodeType): string; static; inline;

    class constructor Init;

  public

    class property Items[const index: TSyntaxNodeType]: string read GetItem; default;

  end;


  TForm1 = class(TForm)
    Button1: TButton;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

uses TypInfo;



{ TSyntaxNodeNames }



class function SyntaxNodeNames.GetItem(const index: TSyntaxNodeType): string;

begin

  Result:= FData[index];

end;



class constructor SyntaxNodeNames.Init;

var

  value: TSyntaxNodeType;

begin

  for value := Low(TSyntaxNodeType) to High(TSyntaxNodeType) do

    FData[value] := Copy(LowerCase(GetEnumName(TypeInfo(TSyntaxNodeType), Ord(value))), 3);

end;



procedure TForm1.Button1Click(Sender: TObject);

begin

  Button1.Caption := SyntaxNodeNames[ntAddr];

end;



end.

